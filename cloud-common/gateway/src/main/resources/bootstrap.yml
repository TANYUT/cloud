server:
  port: 7777
spring:
  application:
    name: gateway
  cloud:
    nacos:
      discovery:
        server-addr: 127.0.0.1:8848
#      config:
#        file-extension: yml
#        server-addr: 127.0.0.1:8848
  gateway:
    discovery:
      locator:
        enabled: true
    routes:
      - id: demo
        uri:  lb://demo  #  lb代表从注册中心获取服务 可以负载均衡
        predicates:
          #- Header=demoHeader, \d{6}  # 访问请求头必须要有这个  后面跟的是正则表达
          - Path=/demo/**  #匹配后面的路径
        filters:
          - name: RequestRateLimiter   #filter名称必须是RequestRateLimiter 才能限流
            args:
              redis-rate-limiter.replenishRate: 10 #允许用户每秒处理多少个请求
              redis-rate-limiter.burstCapacity: 20 #令牌桶的容量，允许在一秒钟内完成的最大请求数
              key-resolver: "#{@ipKeyResolver}"  #使用SpEL按名称引用bean
      #            - Retry=5  #  重试5次
      #            - StripPrefix=1
      #        # 用户管理
      - id: gateway-demo
        uri: lb://gateway-demo
        predicates:
          - Path=/gatewaydemo/**
        filters:
